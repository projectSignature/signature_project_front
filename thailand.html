<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thailand Trip Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;

            color: #333;
           height: 100%;
           overflow: hidden;

        }
        html{
          height: 100%;
        }
        header {
          height:7%;
            background: linear-gradient(45deg, #007BFF, #0056b3);
            color: white;
            text-align: center;
            display:  flex;
            overflow: hidden;
            justify-content: center;
        }
        header h1{
          margin:0
        }
        header img{
          height: 100%
        }
        .container {
            margin: 20px auto;
            max-width: 1200px;
            padding: 0 20px;
            height: 80%;
            overflow-y: auto;

        }
        .schedule {
            margin-bottom: 2rem;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        .day-header {
            background-color: #007BFF;
            color: white;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 600;
        }
        .slideshow-container {
            position: relative;
            max-width: 100%;
            margin: auto;
            overflow: hidden;
            border-radius: 12px;
        }
        .slides {
            display: none;
        }
        .slideshow-container img {
            width: 100%;
            border-radius: 10px;
        }
        .upload-section {
            margin-top: 2rem;
            text-align: center;
        }
        .upload-section input[type="file"] {
            display: none;
        }
        .upload-section label {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border-radius: 8px;
            cursor: pointer;
        }
        .illustration {
            text-align: center;
            margin: 2rem 0;
        }
        .illustration img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
        }
        .upload-section {
            margin-top: 2rem;
            text-align: center;
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        .upload-section input[type="file"], .upload-section input[type="date"], .upload-section textarea {
            margin-top: 1rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .upload-section input {
            display: inline-block;
            padding: 10px 20px;
            /* background-color: #007BFF; */
            /* color: white; */
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .upload-section label:hover {
            background-color: #0056b3;
        }
        textarea {
            width: 80%;
            height: 100px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            transition: border-color 0.3s ease;
        }
        textarea:focus {
            border-color: #007BFF;
        }
        .upload-section button{
          background-color: #007BFF;
           color: white;
           width:8rem;
           margin-top: 10px;
           border-radius: 5px;
           font-size: 1.2em
        }
        .gallery-button {
           position: absolute;
           bottom: 20px;
           right: 20px;
           background-color: #007BFF;
           color: white;
           border: none;
           padding: 15px 20px;
           border-radius: 50px;
           font-size: 1rem;
           font-weight: bold;
           cursor: pointer;
           box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
           transition: background-color 0.3s, transform 0.2s ease-in-out;
       }
       .gallery-button:hover {
           background-color: #0056b3;
           transform: scale(1.1);
       }

       /* モーダルのスタイル */
.modal {
    display: none; /* 初期状態で非表示 */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8); /* 背景の半透明 */
    z-index: 1000;
    overflow-y: auto; /* 縦方向スクロールを有効化 */
}

/* モーダル内のコンテンツ */
.modal-content {
    margin: 50px auto;
    padding: 20px;
    max-width: 90%; /* 画面幅に対応 */
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    text-align: center;
}

/* 閉じるボタン */
.close-button {
    position: absolute;
    top: 20px;
    right: 20px;
    background: #dc3545;
    color: white;
    border: none;
    padding: 10px 15px;
    font-size: 1.5rem;
    cursor: pointer;
    border-radius: 50%;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.close-button:hover {
    background: #b02a37;
}

/* 画像リスト */
.image-list img {
    width: 90%; /* モーダル内での画像幅を調整 */
    margin: 20px auto;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
    </style>
</head>
<body>
    <header>
      <div><img src='https://orders-image.sgp1.digitaloceanspaces.com/Thailand/taikoki.png'/></div>

        <div><h1>タイ旅行日記</h1></div>
        <div><img src='https://orders-image.sgp1.digitaloceanspaces.com/Thailand/taizou.png'/></div>

    </header>

    <div class="container">
        <!-- Day 1 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 1】12/26関空→バンコク</div>
            <p><strong>ﾊﾟｳﾛ家出発</strong>：02：30</p>
            <p><strong>陳家出発</strong>：03：00</p>
            <p><strong>関空着</strong>：06：30</p>
            <p><strong>フライト1</strong> VJ829 - 関空(KIX)→シンガポール(SGN), 出発09:30　到着13:30</p>
            <p><strong>座席：</strong>18A,18B,18C,18D,18E</p>
            <p><strong>予約番号：</strong>FP4WQ6,679VVM</p>
            <p><strong>フライト2</strong> VJ805 - シンガポール(SGN)→バンコク(BKK), 出発17:35 到着19:05</p>
            <p><strong>座席</strong>指定無し</p>
            <p><strong>予約番号：</strong>FP4WQ6,679VVM</p>
            <p><strong>空港－ホテル:</strong>ミニバス（プライベート予約　出発：19:10 到着:19:44</p>
            <p><strong>予約番号：</strong>94102226　Tianjin OUYA Automobile Rental Service</p>
            <p><strong>ホテル名：</strong>Siam Champs Elyseesi Unique Hotel</p>
            <p><strong>ホテル滞在期間：</strong>12月26日から12月29日</p>
            <p><strong>ホテル住所：</strong>160 Ratchadamnoenklang Tai Road, Bowonniwet, Pranakhon, Phra Nakhon, 10200 Bangkok, Tailandia</p>
            <p><strong>予約番号：</strong>4649445063</p>
        </div>

        <!-- Day 2 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 2】12/27バンコク滞在</div>
            <p>フリー、特に計画なし</p>
        </div>

        <!-- Day 3 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 3】12/28バンコク滞在</div>
            <p><strong>クルーザーディナー：</strong>19:30-21:30</p>
            <p><strong>予約番号：</strong>BK617010490064279</p>
            <p><strong>住所：</strong>ASIATIQUE The Riverfront at Warehouse #7,2194 Charoen krung Rd, Wat Phraya Krai, Bang Kho Laem, Bangkok, 10120</p>
        </div>
        <!-- Day 4 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 4】12/29バンコク滞在→プーケット移動</div>
            <p><strong>チェックアウト</strong>12：00</p>
            <p><strong>昼間フリー</strong>特に予定なし</p>
            <p><strong>フライト3</strong> DD534 - バンコク(BKK)→プーケット(HKT), 出発19:15 到着20:35</p>
            <p><strong>座席：</strong>指定無し</p>
            <p><strong>予約番号：</strong>ATL7NA,1691AK</p>
        </div>

        <!-- Day 5 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 5】12/30プーケット滞在</div>
            <p><strong>島めぐり(終日)</strong>　時間未定(前日連絡あり)</p>
            <p><strong>予約番号：</strong>3512201</p>
        </div>

        <!-- Day 5 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 6】12/31プーケット滞在</div>
            <p>フリー、特に計画なし</p>

        </div>
        <!-- Day 5 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 7】1/1プーケット滞在</div>
            <p>フリー、特に計画なし</p>
        </div>
        <!-- Day 5 Schedule -->
        <div class="schedule">
            <div class="day-header">【Day 8】1/2プーケット→日本</div>
            <p><strong>チェックアウト</strong>12：00</p>
            <p><strong>フライト4</strong> MU2082 - プーケット(HKT)→XIANYANG(XIY), 出発00:05 到着06:05</p>
            <p><strong>座席：</strong>46A,46B,46C,46J,46K</p>
            <p><strong>予約番号：</strong>NW3ZT1,MVL7DS</p>
            <p><strong>フライト5</strong> MU2231 - XIANYANG(XIY)→SHANGHAI(PVG), 出発13:30 到着15:50</p>
            <p><strong>座席：</strong>指定無し</p>
            <p><strong>予約番号：</strong>NW3ZT1,MVL7DS</p>
            <p><strong>フライト6</strong> MU729 - SHANGHAI(PVG)→関空(KIX), 出発18:05 到着21:00</p>
            <p><strong>座席：</strong>67H,67G,67F,67D,67J</p>
            <p><strong>予約番号：</strong>NW3ZT1,MVL7DS</p>
            <p><strong>関空出発</strong>：22:00</p>
            <p><strong>陳家着</strong>：02:30</p>
            <p><strong>ﾊﾟｳﾛ家着</strong>：03:00</p>
        </div>
        <!-- Image Upload Section -->
        <div class="upload-section">
              <h2>アップロード</h2>
              <form id="uploadForm" action="/upload" method="POST" enctype="multipart/form-data">
                  <input type="file" id="image" name="image" accept="image/*" required>
                  <input type="date" id="date" name="date" required>
                  <textarea id="comment" name="comment" placeholder="コメントを入力してください..." ></textarea>
                  <button type="submit">保存</button>
              </form>
          </div>
      </div>
      <div id="notification" style="display: none;"></div>
      <button class="gallery-button" onclick="openModal()">ギャラリー</button>

      <!-- モーダル -->
   <div id="galleryModal" class="modal">
       <div class="modal-content">
           <button class="close-button" onclick="closeModal()">×</button>
           <div class="image-list" id="imageList">
               <!-- 画像リストを動的に挿入 -->
           </div>
       </div>
   </div>


    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
   // 今日の日付を取得してフォーマット
   const today = new Date().toISOString().split('T')[0];
   document.getElementById('date').value = today;

   // フォーム送信イベント
   const uploadForm = document.getElementById('uploadForm');
   if (uploadForm) {
       uploadForm.addEventListener('submit', async (e) => {
           e.preventDefault(); // デフォルトのフォーム送信を防止
           console.log('フォームが送信されました');

           const formData = new FormData();
           formData.append('image', document.getElementById('image').files[0]);
           formData.append('date', document.getElementById('date').value);
           formData.append('comment', document.getElementById('comment').value);

           try {
               const response = await fetch('https://squid-app-ug7x6.ondigitalocean.app/tairyokou/upload', {
                   method: 'POST',
                   body: formData,
               });

               const result = await response.json();
               if (response.ok) {
                   showNotification('アップロード成功: ' + result.message, 'success');

                   // フォーム内容をクリア
                   uploadForm.reset();

                   // 日付フィールドを今日の日付にリセット
                   document.getElementById('date').value = today;
               } else {
                   showNotification('エラー: ' + result.error, 'error');
               }
           } catch (error) {
               console.error('アップロード中にエラーが発生しました:', error);
               showNotification('アップロード中にエラーが発生しました', 'error');
           }
       });
   } else {
       console.error('uploadFormが見つかりません');
   }

   // 通知を表示する関数
   function showNotification(message, type) {
       const notification = document.getElementById('notification');
       notification.textContent = message;
       notification.style.display = 'block';
       notification.style.position = 'fixed';
       notification.style.bottom = '20px';
       notification.style.right = '20px';
       notification.style.padding = '10px 20px';
       notification.style.borderRadius = '8px';
       notification.style.fontSize = '16px';
       notification.style.color = 'white';
       notification.style.zIndex = '1000';
       notification.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.1)';

       if (type === 'success') {
           notification.style.backgroundColor = '#28a745'; // 緑
       } else {
           notification.style.backgroundColor = '#dc3545'; // 赤
       }

       // 1秒後に通知を消す
       setTimeout(() => {
           notification.style.display = 'none';
       }, 1000);
   }
});

// モーダルを開く
// モーダルを開く
async function openModal() {
    const modal = document.getElementById('galleryModal');https://squid-app-ug7x6.ondigitalocean.app
    modal.style.display = 'block'; // モーダルを表示

    try {
        // サーバーから全ての画像を取得
        const response = await fetch('https://squid-app-ug7x6.ondigitalocean.app/tairyokou/images');
        const data = await response.json();

        const imageList = document.getElementById('imageList');
        imageList.innerHTML = ''; // 初期化

        if (response.ok) {
            // 日付ごとに画像を分類
            const imagesByDate = {};
            data.images.forEach(image => {
                if (!imagesByDate[image.date]) {
                    imagesByDate[image.date] = [];
                }
                imagesByDate[image.date].push(image);
            });

            // 日付ごとにコンテナを作成
            for (const [date, images] of Object.entries(imagesByDate)) {
                const dateContainer = document.createElement('div');
                dateContainer.style.marginBottom = '30px';

                const dateHeader = document.createElement('h3');
                dateHeader.textContent = date;
                dateHeader.style.color = '#007BFF';

                const imageContainer = document.createElement('div');
                imageContainer.style.display = 'flex';
                imageContainer.style.gap = '10px';
                imageContainer.style.overflowX = 'auto';

                images.forEach(image => {
                    const imgWrapper = document.createElement('div');
                    imgWrapper.style.flexShrink = '0';

                    const img = document.createElement('img');
                    img.src = image.image_url;
                    img.alt = image.comment || 'No comment';
                    img.style.width = '200px';
                    img.style.borderRadius = '8px';

                    const caption = document.createElement('p');
                    caption.textContent = image.comment || 'No comment';
                    caption.style.textAlign = 'center';
                    caption.style.color = '#555';
                    caption.style.fontSize = '0.9rem';

                    imgWrapper.appendChild(img);
                    imgWrapper.appendChild(caption);
                    imageContainer.appendChild(imgWrapper);
                });

                dateContainer.appendChild(dateHeader);
                dateContainer.appendChild(imageContainer);
                imageList.appendChild(dateContainer);
            }
        } else {
            imageList.innerHTML = `<p>${data.message || 'エラーが発生しました'}</p>`;
        }
    } catch (error) {
        console.error('画像取得中にエラーが発生しました:', error);
        const imageList = document.getElementById('imageList');
        imageList.innerHTML = '<p>画像を取得できませんでした。</p>';
    }
}

// モーダルを閉じる
function closeModal() {
    const modal = document.getElementById('galleryModal');
    modal.style.display = 'none'; // モーダルを非表示
}


    </script>

</body>
</html>
